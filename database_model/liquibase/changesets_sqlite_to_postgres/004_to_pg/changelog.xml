<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
    http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd"
		 logicalFilePath="004_to_pg/changelog.xml">

	<changeSet author="patrick_schmitz" id="004_to_pg">
		<validCheckSum>ANY</validCheckSum>
		<executeCommand executable="python3"> 
			<arg value="../../../database_model/liquibase/changesets_sqlite_to_postgres/004_to_pg/sqlite_views_ifnull_coalesce.py"/>
		</executeCommand>

      	<sqlFile dbms="postgresql"
        	encoding="UTF-8"
        	endDelimiter="\n;"
        	path="../../../database_model/liquibase/changesets_sqlite_to_postgres/004_to_pg/create_everything_for_all_views.sql"
        	relativeToChangelogFile="false"
        	splitStatements="false"
        	stripComments="false"/>

		<!-- <executeCommand executable="python3">  -->
		<!-- 	<arg value="-c"/> -->
		<!-- 	<arg value="import os; f = open(os.path.join('/tmp/test.txt'), 'w');  f.write(os.getcwd())"/> -->
		<!-- </executeCommand> -->

		<!-- <executeCommand executable="python3">  -->
		<!-- 	<arg value="-c"/> -->
		<!-- 	<arg value="import os; os.remove(os.path.join('..','database','create_everything_for_all_views.sql'))"/> -->
		<!-- </executeCommand> -->

		<comment>
		<![CDATA[
		Run sqlite_views_ifnull_coalesce.py. CREATE FUNCTION instr. CREATE all views.
		Phabricator tasks:
			T312
		]]>
		</comment>
	</changeSet>
</databaseChangeLog>
